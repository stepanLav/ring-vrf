\section{Security Model of Ring VRF}


In this section, we describe the security of our new cryptographic primitive ring VRF. First, we describe the basic ring VRF in the real world and in the ideal world. Second, we extend the basic ring VRF by adding a new property that we call secret evaluation. 


\paragraph{Ring VRF (Basic Definition):} A ring VRF operates like a VRF but only proves its key comes from a specific list without giving any information about which specific key. We define the ring VRF functionality $ \fgvrf $ in Figure \ref{f:gvrf}. The functionality lets parties generate a key (Key Generation), evaluate a message with the party's key (VRF Evaluation), prove that the evaluation is executed by one of the keys (VRF evaluation and proof) and verify the evaluation without knowing the key used for the evaluation (Verification). We also define linking procedures in $ \fgvrf $ to link an evaluation and a proof with its associated key. So, if a party wants to reveal its identity at some point, it can use the linking process to prove that the evaluation is executed with its key (Linking proof). Later on, anyone can verify the linking proof (Linking verification).
%TODO Secret Evaluation
\input{rvrf_functionality}
In a nutshell, the functionality $\fgvrf$, when given as input a message $m$ and a key set $\pkring$ of participant, allows to create $n$ possible different outputs pseudo-random that appear independent from the inputs. The output can be verified to have been computed correctly by one of the participants in $\pkring$ without revealing who they are. At a later stage, the author of the VRF output can prove that the output was generated by them and no other participant could have done so.

Below, we define the real-world execution of the ring VRF.
\begin{definition}[Ring-VRF (rVRF)]\label{def:ringvrf}
	Ring VRF is a VRF with a deterministic function $ F(.,.):\{0,1\}^\kappa \times\{0,1\}^* \rightarrow \{0,1\}^{\ell_\rvrf} $ and with the following algorithms:
	
	\begin{itemize}
		\item $ \rvrf.\keygen(1^\kappa) \rightarrow (\skrvrf,\pkrvrf)$ where $ \kappa $ is the security parameter,
	\end{itemize}
	Given list of public keys $ \pkring = \set{\pkrvrf_1, \pkrvrf_2, \ldots, \pkrvrf_n}$, a message $ m \in \{0,1\}^* $
	\begin{itemize}
		\item $ \rvrf.\eval(\skrvrf_i, \pkring, m)\rightarrow y $ where $ y = F(\skrvrf,\pkring,m) $,
		\item $ \rvrf.\evalprove(\skrvrf_i, \pkring, m)\rightarrow (F(\skrvrf,\pkring,m),\pi) $ where  $ \pi $ is a proof for the evaluation.
		\item $ \rvrf.\verify(\pkring, m, y,\pi) \rightarrow  b$ where $ b \in \{0,1\} $. $ b =1 $ means verified and $ b = 0 $ means not verified.
		\item $ \rvrf.\link(\skrvrf_i, \pkring,m,y, \pi) \rightarrow \pi_{\link} $ where  $ \pi^\link $ is a proof linking the public key of the producer of $ y $. 
		\item $ \rvrf.\link\verify(\pkring, \skrvrf_i, m, y, \pi,, \pi_{\link})\rightarrow b$ where $ b \in \{0,1\} $. $ b =1 $ means verified and $ b = 0 $ means not verified.
	\end{itemize}
	
\end{definition}
\paragraph{Ring VRF with Secret Evaluation:} 


Below, we define the real-world execution of the ring VRF with secret evaluation.
\begin{definition}[Ring-VRF (rVRF)]\label{def:ringvrfse}
	Ring VRF with secret evaluation is two VRFs with a deterministic function $ F(.,.):\{0,1\}^\kappa \times\{0,1\}^* \rightarrow \{0,1\}^{\ell_\rvrf} $ and$ F_s(.,.):\{0,1\}^\kappa \times\{0,1\}^* \rightarrow \{0,1\}^{\ell_\rvrf} $. It consists of the algorithms of ring VRF defined in Definition \ref{def:ringvrf} and additionally the following algorithms:
	
	Given list of public keys $ \pkring = \set{\pkrvrf_1, \pkrvrf_2, \ldots, \pkrvrf_n}$, a message $ m \in \{0,1\}^* $
	\begin{itemize}
		\item $ \rvrf.\secreteval(\skrvrf_i, \pkring, m)\rightarrow \omega $ where $ \omega = F_s(\skrvrf,\pkring,m) $,
		\item $ \rvrf.\secretprove(\skrvrf_i, \pkring, m)\rightarrow \pi / \perp $ where  $ \pi $ is a proof for the secret evaluation. If $ (F_s(\skrvrf,\pkring,m), (\pkring, m)) \notin \rel  $, it outputs $ \perp $.
		\item $ \rvrf.\secretverify(\pkring, m,\pi) \rightarrow  b$ where $ b \in \{0,1\} $. $ b =1 $ means verified and $ b = 0 $ means not verified.
	\end{itemize}
	
\end{definition}

\input{rvrf_se_functionality}