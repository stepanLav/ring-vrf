\subsection{Ring VRF in the UC Model}


In this section, we describe the security of our new cryptographic primitive ring VRF. We describe the  ring VRF in the real world and in the ideal world. 

\paragraph{Ring VRF in the real world:}
\begin{definition}[Ring-VRF (rVRF)]\label{def:ringvrf}
	%TODO ADD anonymous key here
	A ring VRF is a VRF with a  function $ F(.):\{0,1\}^* \rightarrow \{0,1\}^{\ell_\rvrf} $ and with the following algorithms:
	
	\begin{itemize}
		\item $ \rvrf.\keygen(1^\secpar) \rightarrow (\sk,\pk)$ where $ \secpar $ is the security parameter,
	\end{itemize}
	Given list of public keys $ \comring = \set{\pk_1, \pk_2, \ldots, \pk_n}$, a message $ m \in \{0,1\}^{\ell_m} $
	\begin{itemize}
		\item $ \rvrf.\sign(\sk_i, \comring, m)\rightarrow (\sigma,W) $ where  $\sigma $ is a signature of the message $ m $ signed by $ \sk_i, \comring $ and $ W $ is an anonymous key.
		\item $ \rvrf.\verify(\comring,W, m,\sigma) \rightarrow  (b, y)$ where $ b \in \{0,1\} $ and $ y \in \{0,1\}^{\ell_\rvrf}\cup \{\perp\} $. $ b =1 $ means verified and $ b = 0 $ means not verified.
		\item $ \rvrf.\link(\sk_i, \comring,W,m, \sigma) \rightarrow \hat\sigma $ where  $ \hat\sigma $ is a signature that links signer of the ring signature $ \sigma $. 
		\item $ \rvrf.\link\verify( \pk_i,\comring,W, m, \sigma, \hat\sigma)\rightarrow b$ where $ b \in \{0,1\} $. $ b =1 $ means verified and $ b = 0 $ means not verified.
	\end{itemize}
\end{definition}

\paragraph{Ring VRF in the ideal world:} 
%A ring VRF operates like a VRF but only proves its key comes from a specific list without giving any information about which specific key. 
We define the ring VRF functionality $ \fgvrf $ in Figure \ref{f:gvrf}. The functionality lets parties generate a key (Key Generation), evaluate a message with the party's key (Ring VRF Evaluation), sign a message by one of the keys (Ring VRF signature) and verify the signature and obtain the evaluation output without knowing the key used for the signature and evaluation (Ring VRF Verification). We also define linking procedures in $ \fgvrf $ to link a signature with its associated key. So, if a party wants to reveal its identity at some point, it can use the linking process to show that the evaluation is executed with its key (Linking Signature). Later on, anyone can verify the linking signature (Linking Verification).

In a nutshell, the functionality $\fgvrf$, when given as input a message $m$ and a key set $\comring$ (that we call a ring) of party, allows to create $n$ possible different outputs pseudo-random that appear independent from the inputs. The output can be verified to have been computed correctly by one of the participants in $\comring$ without revealing who they are. At a later stage, the author of the ring VRF output can prove that the output was generated by him and no other participant could have done so.
\input{rvrf_functionality}
We give some remarks related to our functionality:

\begin{enumerate}[label={{R-} }{{\arabic*}}, start = 1]
	
	%\item The ring VRF signature does not need to be random but it must be \emph{unique}  for its ring and the message. The reason of it to have a mapping from a ring VRF signature to its evaluation output. The map is necessary for $ \fgvrf $ to output the corresponding evaluation value for the signature during the verification process i.e, $ [m, \comring, \sigma] \rightarrow \pk, \evaluationsecretlist[m, \comring][\pkvrf] \rightarrow y $.
	\item In classical VRF, a VRF $ F $ is a deterministic function which maps a message and a public key to a random output. While in ring VRF, a message, a public key and a ring map to a random value, the verification algorithm of a ring VRF does not take the key as an input because it should be hidden. Therefore, the verification should be executed without the public key.  So, the functionality $ \fgvrf $ needs to find a way to verify the ring VRF output of a message, a public key and a ring map without knowing the public key. Because of this, $ \fgvrf $ generates an anonymized key $ W $ for each evaluation so that a message $ m $  and $ W $ maps to the random output. One can imagine this  as if a VRF output is generated with the input message $ m $ and the key $ W $ as in classical VRF i.e.,  $ F(m, W) $. 
	
	\item  If an honest party signs a message for a ring and obtains a signature, $ \fgvrf $ allows the simulator to generate another signature in \ref{cond:differentsignature} if the simulator wants. We remark that this is not a security issue because an honest party has already committed to sign the message.  A similar condition  exists in the EUF-CMA secure signature functionality $ \fsig $ \cite{canettiFsig}.
	
	\item \ref{cond:advsignature} of the ring VRF verification process covers the case where the adversary decides whether accepting the signature generated for its key if  it could be a valid signature for the ring i.e., the malicious key is in the ring and the anonymous key in the verification request is unique.
	
	\item The linking signature and the linking verification works similar to the EUF-CMA secure signature functionality $ \fsig $ \cite{canettiFsig}.
	
	
\end{enumerate}


\begin{definition}[Anonymous $ \fgvrf $]\label{def:anonymity}
	We call that $ \fgvrf $ is anonymous if the outputs of $ \gen_{sign} $ and $ \gen_W $ are pseudo-random.
	%TODO define this more formally.
\end{definition}




	

